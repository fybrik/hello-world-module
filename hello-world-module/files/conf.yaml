{{ if and (.Values.assets) (eq (len .Values.assets) 1) -}}
data:
{{- with (index .Values.assets 0) }}
  - format: {{ .source.format | quote }}
    vault_credentials:
      address: {{ .source.vault.read.address | quote}}
      authPath: {{ .source.vault.read.authPath | quote}}
      role: {{ .source.vault.read.role }}
      secretPath: {{ .source.vault.read.secretPath | quote}}
    {{- $connection := .source.connection | default dict -}}
    {{ if $connection.s3 | quote}}
    s3.bucket: {{ $connection.s3.bucket | quote}}
    s3.endpoint: {{ $connection.s3.endpoint | quote}}
    {{ end }}
    connection.name: {{ $connection.name | quote }}
{{ end }}
{{ else }}
data: []
{{ end }}
